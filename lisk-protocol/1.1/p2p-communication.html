<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lisk Peer-to-Peer Communication :: Lisk Docs Demo Site</title>
    <link rel="canonical" href="http://104.248.38.54/lisk-protocol/1.1/p2p-communication.html">
    <meta name="generator" content="Antora 2.1.2">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<!--
    <link href="https://unpkg.com/primer/build/build.css" rel="stylesheet">
-->

  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a href="http://104.248.38.54" class="lisk-logo"></a>
      Lisk Docs Demo Site
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-sdk">Lisk SDK Github</a>
            <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-core">Lisk Core Github</a>
            <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-hub">Lisk Hub Github</a>
            <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-mobile">Lisk Mobile Github</a>
            <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-explorer">Lisk Explorer Github</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://explorer.lisk.io/">Lisk Mainnet Explorer</a>
            <a class="navbar-item" target="_blank" href="https://testnet-explorer.lisk.io/">Lisk Testnet Explorer</a>
            <a class="navbar-item" target="_blank" href="https://testnet-faucet.lisk.io/">Lisk Testnet Faucet</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://lisk.io">Lisk Website</a>
            <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-sdk-examples">Example blockchain applications</a>
              <a class="navbar-item" target="_blank" href="https://www.liskdiscovery.com/">Community tools</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="lisk-protocol" data-version="1.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Lisk Protocol</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="blocks.html">Blocks</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="consensus.html">Consensus</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="p2p-communication.html">Peer-to-Peer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="transactions.html">Tansactions</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk Protocol</span>
    <span class="version">1.1</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Lisk Core</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../lisk-core/index.html">2.1.3 (latest)</a>
        </li>
        <li class="version">
          <a href="../../lisk-core/2.0/introduction.html">2.0.2</a>
        </li>
        <li class="version">
          <a href="../../lisk-core/1.6/introduction.html">1.6.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Lisk Protocol</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.1</a>
        </li>
        <li class="version">
          <a href="../1.0/introduction.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Lisk SDK</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../lisk-sdk/index.html">2.3.6 (latest)</a>
        </li>
        <li class="version">
          <a href="../../lisk-sdk/2.2/introduction.html">2.2.0</a>
        </li>
        <li class="version">
          <a href="../../lisk-sdk/2.1/introduction.html">2.1.0</a>
        </li>
        <li class="version">
          <a href="../../lisk-sdk/2.0/introduction.html">2.0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../lisk-sdk/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Lisk Protocol</a></li>
    <li><a href="p2p-communication.html">Peer-to-Peer</a></li>
  </ul>
</nav>
<button class="toc-toggle"></button>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.1</button>
  <div class="version-menu">
    <a class="version is-current" href="p2p-communication.html">1.1</a>
    <a class="version" href="../1.0/p2p-communication.html">1.0</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/docs-protocol-1.1/modules/ROOT/pages/p2p-communication.adoc">Edit this Page</a></div>
</div>
<article class="doc"><a name="section-top"></a>
<h1>Lisk Peer-to-Peer Communication</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Peer-to-Peer communication serves a vital function within the Lisk network.
The peering mechanisms provide the required architecture to facilitate network consensus, block propagation and transaction propagation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture"><a class="anchor" href="#_architecture"></a>Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The peers in the Lisk network use JSON objects with compressed <a href="blocks.md"><strong>blocks</strong></a> and <a href="transactions.md"><strong>transactions</strong></a>.
The Lisk logic running on every node in the Lisk network uses remote procedure calls (RPCs) and events to communicate the transaction and block JSON objects to the other peers.
The RPCs and events are also transmitted as JSON objects with additional fields telling the Lisk application which method to use in order to process the transmitted object.
In order to effectively transmit these JSON objects to the other peers, websockets are used via the <a href="https://socketcluster.io">SocketCluster Framework</a>.
An overview of the architecture of the peer-to-peer communication in Lisk is provided below.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/lisk_protocol-p2parchitecture.png" alt="lisk_protocol-p2parchitecture" title="lisk_protocol-p2parchitecture"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_system_headers"><a class="anchor" href="#_system_headers"></a>System Headers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every time a Lisk node communicates with a peer of the Lisk network, a system header is added to the message.
The system headers are used to identify full nodes and provide basic information about the software running on the system.</p>
</div>
<div class="paragraph">
<p>The following JSON object is generated from system data for this purpose:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "os":"darwin16.3.0",
  "version":"0.6.0a",
  "port":7000,
  "height":1574654,
  "nethash":"da3ed6a45429278bac2666961289ca17ad86595d33b31037615d4b8e8f158bba",
  "broadhash":"c7e0902a7016205d456a427edda2b09f4b875f98ef40a224018a0274347146ac",
  "minVersion":"&gt;=0.5.0"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_block_propagation"><a class="anchor" href="#_block_propagation"></a>Block Propagation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Block propagation serves a vital function on the Lisk network.
Without block propagation, the system would grind to a halt and the blockchain would cease to function.
Blocks are made in a decentralized fashion and must be sent to all nodes on the network in order to establish consensus.
When a block is generated, it is broadcast to 25 randomly selected peers.
These forward the validated block to 25 randomly selected peers and so on.
In order to prevent overbroadcasting of data, every block is given a relay limit of 3 and blocks that have already been received are not broadcast again.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_transaction_propagation"><a class="anchor" href="#_transaction_propagation"></a>Transaction Propagation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Transactions must move from one node to all other nodes in order to be included in blocks.
The broadcast queue for transactions works by drawing up to 25 transactions from the transactions pool and performing a validation process on those transactions.
These transactions are then broadcast to other nodes in a bundled JSON object.
This can be represented as an array of objects, depending on the <a href="transactions.html" class="page">transaction type</a>.
The bundle is then broadcast to the network at regular intervals, currently specified as every 5 seconds.
The time delay allows the bundle to accumulate additional transactions from the network (up to 25).
In addition to broadcasting the object, the bundle is given a relay limit to prevent spamming the network.
In the current implementation the relay limit is set as 3, which means that every bundle will be broadcast for <strong>at most 3 hops</strong> by the peers on the network.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_transaction_pool"><a class="anchor" href="#_transaction_pool"></a>Transaction Pool</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The transaction pool provides the Lisk network a robust solution for preserving unconfirmed transactions that have overflowed into the next block.
As described in <a href="blocks.md"><strong>blocks</strong></a>, each block can only include 25 transactions and the transaction pool allows up to 1.000 multisignature transactions and other 1.000 for the remaining transaction types to remain queued for the next block(s).
The transaction pool could be thought of as a memory pool, keeping transactions ready until they are signed into a block.
The second usage of the transaction pool is to provide a mechanism for propagating transactions.
When a node prepares a transaction bundle, it draws up to 25 transactions from the pool and broadcast them to the network.
In order to keep the transaction pool tidy, all transactions are given a time to live.
This time to live is defined as 10800 seconds, or 1080 blocks.
The final use for the transaction pool is to house transactions with pending signatures.
Like unconfirmed transactions, these transactions will expire out of the pool based on the lifetime specified when the transaction is first received.</p>
</div>
</div>
</div>
</article>
<aside class="article-aside hidden" role="navigation">
    <h3 class="toc-title">On this page:</h3>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
  <p>Go to the <a href="https://lisk.io/" target="_blank">Lisk Website</a></p>
  <p>Chat with developers at <a href="https://gitter.im/LiskHQ/lisk-sdk" target="_blank">Lisk Gitter</a></p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.1.1/tocbot.min.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs-block-behaviour.js"></script>
<script>
    tocbot.init( {
        tocSelector: '#article-toc',
        contentSelector: 'article',
        headingSelector: 'h1, h2, h3',
        collapseDepth: 6,
        positionFixedSelector: null,
        scrollSmooth: false
    } );
    var tocList = document.getElementById( 'article-toc' ).getElementsByClassName( 'toc-list' );
    if ( tocList && tocList.length > 0 && tocList[0].childNodes.length > 0 ) {
        document.getElementById( 'article-toc' ).parentNode.classList.remove( 'hidden' );
    }
</script>
  </body>
</html>
